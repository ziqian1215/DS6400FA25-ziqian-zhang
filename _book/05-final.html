<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Final Exam – ML1 Portoflio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./04-nonlinearity.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-final.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Final Exam</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ML1 Portoflio</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-performance-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Measures of model performance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-partial-effect-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-4-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">4 Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">How Random Forests Capture Nonlinearity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-final.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Final Exam</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#question-1" id="toc-question-1" class="nav-link active" data-scroll-target="#question-1"><span class="header-section-number">6.1</span> Question 1</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process"><span class="header-section-number">6.1.1</span> Data Generating Process</a></li>
  <li><a href="#models-and-tuning-procedures" id="toc-models-and-tuning-procedures" class="nav-link" data-scroll-target="#models-and-tuning-procedures"><span class="header-section-number">6.1.2</span> Models and Tuning Procedures</a></li>
  <li><a href="#evaluation-metrics" id="toc-evaluation-metrics" class="nav-link" data-scroll-target="#evaluation-metrics"><span class="header-section-number">6.1.3</span> Evaluation Metrics</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">6.1.4</span> Results</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">6.1.5</span> Summary</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Final Exam</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="question-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="question-1"><span class="header-section-number">6.1</span> Question 1</h2>
<section id="data-generating-process" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="data-generating-process"><span class="header-section-number">6.1.1</span> Data Generating Process</h3>
<p>We generate synthetic data from a linear regression model with a finite sample size of <strong>N = 200</strong> observations and <strong>p = 50</strong> predictor variables. The response variable is generated according to</p>
<p><span class="math display">\[
Y = X\beta + \varepsilon, \qquad \varepsilon \sim \mathcal{N}(0_N, I_N),
\]</span></p>
<p>where <span class="math inline">\(X \in \mathbb{R}^{N \times p}\)</span> is the design matrix and <span class="math inline">\(\beta \in \mathbb{R}^p\)</span> is the vector of true regression coefficients.</p>
<section id="block-structure" class="level4" data-number="6.1.1.1">
<h4 data-number="6.1.1.1" class="anchored" data-anchor-id="block-structure"><span class="header-section-number">6.1.1.1</span> Block structure</h4>
<p>The predictor matrix is constructed by concatenating four blocks with heterogeneous correlation structures:</p>
<p><span class="math display">\[
X = [\, U \;\; V \;\; W \;\; Z \,],
\]</span></p>
<p>with dimensions</p>
<ul>
<li><span class="math inline">\(U \in \mathbb{R}^{N \times 10}\)</span></li>
<li><span class="math inline">\(V \in \mathbb{R}^{N \times 10}\)</span></li>
<li><span class="math inline">\(W \in \mathbb{R}^{N \times 10}\)</span></li>
<li><span class="math inline">\(Z \in \mathbb{R}^{N \times 20}\)</span></li>
</ul>
<p>The coefficient vector is partitioned accordingly as</p>
<p><span class="math display">\[
\beta = (\alpha^\top, \gamma^\top, \delta^\top, \zeta^\top)^\top ,
\]</span></p>
<p>so that the data generating model can be written in block form as</p>
<p><span class="math display">\[
Y = U\alpha + V\gamma + W\delta + Z\zeta + \varepsilon .
\]</span></p>
<p>Each block is designed to represent a distinct regime in terms of signal strength, sparsity, and predictor correlation.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 19%">
<col style="width: 26%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Block</th>
<th>Dimension</th>
<th>Nonzero Coefficients</th>
<th>Signal Strength</th>
<th>Correlation Structure</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>U</td>
<td>10</td>
<td>1 (α₁ = 3)</td>
<td>Strong, sparse</td>
<td>Equicorrelated (ρ = 0.95)</td>
<td>Assess behavior under severe multicollinearity</td>
</tr>
<tr class="even">
<td>V</td>
<td>10</td>
<td>3 (γ₁–γ₃ = 1.5)</td>
<td>Moderate, sparse</td>
<td>Equicorrelated (ρ = 0.50)</td>
<td>Compare methods with multiple correlated signals</td>
</tr>
<tr class="odd">
<td>W</td>
<td>10</td>
<td>5 (δ₁–δ₅ = 0.3)</td>
<td>Weak, dense</td>
<td>Equicorrelated (ρ = 0.20)</td>
<td>Examine bias–variance trade-offs under weak signals</td>
</tr>
<tr class="even">
<td>Z</td>
<td>20</td>
<td>0</td>
<td>None</td>
<td>Independent (ρ = 0)</td>
<td>Evaluate false positives and shrinkage of noise</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>make_equicorr <span class="ot">&lt;-</span> <span class="cf">function</span>(p, rho){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(rho, p, p); <span class="fu">diag</span>(S) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  S</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>gen_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">200</span>){</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># block sizes</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  pU <span class="ot">&lt;-</span> <span class="dv">10</span>; pV <span class="ot">&lt;-</span> <span class="dv">10</span>; pW <span class="ot">&lt;-</span> <span class="dv">10</span>; pZ <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  p  <span class="ot">&lt;-</span> pU<span class="sc">+</span>pV<span class="sc">+</span>pW<span class="sc">+</span>pZ</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  SU <span class="ot">&lt;-</span> <span class="fu">make_equicorr</span>(pU, <span class="fl">0.95</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  SV <span class="ot">&lt;-</span> <span class="fu">make_equicorr</span>(pV, <span class="fl">0.50</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  SW <span class="ot">&lt;-</span> <span class="fu">make_equicorr</span>(pW, <span class="fl">0.20</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  SZ <span class="ot">&lt;-</span> <span class="fu">diag</span>(pZ)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="at">sigma=</span>SU)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="at">sigma=</span>SV)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="at">sigma=</span>SW)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="at">sigma=</span>SZ)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(U,V,W,Z)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, <span class="fu">seq_len</span>(<span class="fu">ncol</span>(X)))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, p)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alpha</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  beta[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gamma</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  beta[(pU<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(pU<span class="sc">+</span><span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># delta</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  beta[(pU<span class="sc">+</span>pV<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(pU<span class="sc">+</span>pV<span class="sc">+</span><span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zeta already 0</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(X <span class="sc">%*%</span> beta <span class="sc">+</span> eps)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  block <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"U"</span>,pU), <span class="fu">rep</span>(<span class="st">"V"</span>,pV), <span class="fu">rep</span>(<span class="st">"W"</span>,pW), <span class="fu">rep</span>(<span class="st">"Z"</span>,pZ))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">X=</span>X, <span class="at">y=</span>y, <span class="at">beta=</span>beta, <span class="at">block=</span>block)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="models-and-tuning-procedures" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="models-and-tuning-procedures"><span class="header-section-number">6.1.2</span> Models and Tuning Procedures</h3>
<p>All models are fit within a single train–test split using a unified workflow. All tuning and model fitting are performed using training data only, while final performance is evaluated on held-out test data.</p>
<p>Prior to model fitting, predictors are standardized using statistics computed from the training data and applied to both training and test sets to prevent data leakage.</p>
<section id="ordinary-least-squares-ols" class="level4" data-number="6.1.2.1">
<h4 data-number="6.1.2.1" class="anchored" data-anchor-id="ordinary-least-squares-ols"><span class="header-section-number">6.1.2.1</span> Ordinary Least Squares (OLS)</h4>
<p>Ordinary least squares is fit on the standardized training data without regularization:</p>
<p><span class="math display">\[
\hat{\beta}^{\text{OLS}} = \arg\min_{\beta}\|Y - X\beta\|_2^2.
\]</span></p>
<p>OLS provides an unregularized reference point with minimal bias but potentially high variance, particularly in the presence of correlated predictors. Comparisons with OLS help isolate the impact of regularization.</p>
</section>
<section id="ridge-lasso-and-elastic-net" class="level4" data-number="6.1.2.2">
<h4 data-number="6.1.2.2" class="anchored" data-anchor-id="ridge-lasso-and-elastic-net"><span class="header-section-number">6.1.2.2</span> Ridge, Lasso, and Elastic Net</h4>
<p>Regularized regression models are fit using the <strong>glmnet</strong> framework. For ridge, lasso, and elastic net, the tuning parameter <span class="math inline">\(\lambda\)</span> is selected by cross-validation on the training data to minimize mean squared prediction error.</p>
<p>The estimators take the form</p>
<p><span class="math display">\[
\hat{\beta}
= \arg\min_{\beta}\|Y - X\beta\|_2^2
+ \lambda\left(
\alpha\|\beta\|_1 + (1-\alpha)\|\beta\|_2^2
\right),
\]</span></p>
<p>with the following special cases:</p>
<ul>
<li>Ridge regression: <span class="math inline">\(\alpha = 0\)</span></li>
<li>Lasso regression: <span class="math inline">\(\alpha = 1\)</span></li>
<li>Elastic net: <span class="math inline">\(\alpha \in (0,1)\)</span>, fixed at a predefined value</li>
</ul>
<p>For each method, the value of <span class="math inline">\(\lambda\)</span> corresponding to the minimum cross-validated error (<span class="math inline">\(\lambda_{\text{min}}\)</span>) is selected, and the model is refit on the full training set at this value.</p>
</section>
<section id="principal-components-regression-pcr" class="level4" data-number="6.1.2.3">
<h4 data-number="6.1.2.3" class="anchored" data-anchor-id="principal-components-regression-pcr"><span class="header-section-number">6.1.2.3</span> Principal Components Regression (PCR)</h4>
<p>Principal components regression is fit by first computing the principal components of the standardized training predictors. A linear regression model is then fit using the first <span class="math inline">\(k\)</span> components.</p>
<p>The number of retained components <span class="math inline">\(k\)</span> is selected via cross-validation by minimizing the cross-validated root mean squared error. To reduce variance, the smallest <span class="math inline">\(k\)</span> within one standard error of the minimum is chosen.</p>
</section>
<section id="implementation-details" class="level4" data-number="6.1.2.4">
<h4 data-number="6.1.2.4" class="anchored" data-anchor-id="implementation-details"><span class="header-section-number">6.1.2.4</span> Implementation details</h4>
<p>For each fitted model, coefficient estimates and test-set predictions are stored for downstream evaluation. Tuning parameters (selected <span class="math inline">\(\lambda\)</span> or number of components <span class="math inline">\(k\)</span>) are recorded to facilitate comparison across methods.</p>
<p>All subsequent analyses—including prediction accuracy, coefficient estimation error, variable selection stability, and block-wise diagnostics—are based on these fitted models.</p>
</section>
</section>
<section id="evaluation-metrics" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="evaluation-metrics"><span class="header-section-number">6.1.3</span> Evaluation Metrics</h3>
<p>Model performance is evaluated using repeated random train–test splits. Specifically, for each repetition <span class="math inline">\(r = 1,\dots,R\)</span> with <span class="math inline">\(R=60\)</span>, a new dataset is generated, randomly split into a training set (70%) and a test set (30%), and all models are fit and evaluated independently. This yields empirical distributions for all metrics, allowing uncertainty and variability to be assessed.</p>
<hr>
<section id="out-of-sample-predictive-accuracy" class="level4" data-number="6.1.3.1">
<h4 data-number="6.1.3.1" class="anchored" data-anchor-id="out-of-sample-predictive-accuracy"><span class="header-section-number">6.1.3.1</span> Out-of-sample predictive accuracy</h4>
<p>For each method and each repetition, predictive accuracy is measured using the test-set mean squared error (MSE):</p>
<p><span class="math display">\[
\text{MSE}^{(r)} = \frac{1}{n_{\text{test}}}
\sum_{i \in \mathcal{T}_r} (y_i - \hat{y}_i)^2,
\]</span></p>
<p>where <span class="math inline">\(\mathcal{T}_r\)</span> denotes the test set for repetition <span class="math inline">\(r\)</span>.</p>
<p>To assess block-wise predictive contributions, we compute a drop-one-block increase in test MSE. For block <span class="math inline">\(b \in \{U,V,W,Z\}\)</span>, let <span class="math inline">\(\hat{y}_i^{(-b)}\)</span> denote predictions obtained after setting coefficients in block <span class="math inline">\(b\)</span> to zero. The marginal contribution of block <span class="math inline">\(b\)</span> is defined as</p>
<p><span class="math display">\[
\Delta\text{MSE}_b^{(r)}
= \text{MSE}_b^{(r)} - \text{MSE}^{(r)},
\]</span></p>
<p>where <span class="math inline">\(\text{MSE}_b^{(r)}\)</span> is the test MSE using <span class="math inline">\(\hat{y}^{(-b)}\)</span>. Positive values indicate that the block contributes to predictive accuracy.</p>
</section>
<section id="coefficient-estimation-error" class="level4" data-number="6.1.3.2">
<h4 data-number="6.1.3.2" class="anchored" data-anchor-id="coefficient-estimation-error"><span class="header-section-number">6.1.3.2</span> Coefficient estimation error</h4>
<p>Accuracy of coefficient estimation is evaluated using the mean squared error between estimated and true coefficients:</p>
<p><span class="math display">\[
\text{Coef-MSE}^{(r)} = \frac{1}{p}
\sum_{j=1}^{p} \bigl(\hat{\beta}_j^{(r)} - \beta_j\bigr)^2.
\]</span></p>
<p>Block-specific coefficient error is computed analogously by restricting the summation to coefficients belonging to a given block <span class="math inline">\(b\)</span>:</p>
<p><span class="math display">\[
\text{Coef-MSE}_b^{(r)} =
\frac{1}{|b|}
\sum_{j \in b} \bigl(\hat{\beta}_j^{(r)} - \beta_j\bigr)^2.
\]</span></p>
</section>
<section id="variable-selection-stability" class="level4" data-number="6.1.3.3">
<h4 data-number="6.1.3.3" class="anchored" data-anchor-id="variable-selection-stability"><span class="header-section-number">6.1.3.3</span> Variable selection stability</h4>
<p>For methods with an explicit variable selection component (lasso and elastic net), selection is defined by nonzero estimated coefficients. Let <span class="math inline">\(S^{(r)} \subset \{1,\dots,p\}\)</span> denote the selected set in repetition <span class="math inline">\(r\)</span>.</p>
<p>Stability of variable selection is quantified using the Jaccard similarity between selected sets from two repetitions <span class="math inline">\(r\)</span> and <span class="math inline">\(r'\)</span>:</p>
<p><span class="math display">\[
J\bigl(S^{(r)}, S^{(r')}\bigr)
= \frac{|S^{(r)} \cap S^{(r')}|}
{|S^{(r)} \cup S^{(r')}|}.
\]</span></p>
<p>We compute Jaccard similarities over many randomly chosen pairs of repetitions to obtain an empirical distribution. Block-wise selection stability is computed by restricting the selected sets to indices belonging to each block.</p>
</section>
<section id="shrinkage-magnitude-and-coefficient-patterns" class="level4" data-number="6.1.3.4">
<h4 data-number="6.1.3.4" class="anchored" data-anchor-id="shrinkage-magnitude-and-coefficient-patterns"><span class="header-section-number">6.1.3.4</span> Shrinkage magnitude and coefficient patterns</h4>
<p>To summarize the degree of coefficient shrinkage, we compute the <span class="math inline">\(\ell_1\)</span> and <span class="math inline">\(\ell_2\)</span> norms of the estimated coefficient vector:</p>
<p><span class="math display">\[
\|\hat{\beta}^{(r)}\|_1 = \sum_{j=1}^{p} |\hat{\beta}_j^{(r)}|,
\qquad
\|\hat{\beta}^{(r)}\|_2 =
\left(\sum_{j=1}^{p} (\hat{\beta}_j^{(r)})^2\right)^{1/2}.
\]</span></p>
<p>In addition, the full set of estimated coefficients <span class="math inline">\(\hat{\beta}^{(r)}\)</span> is retained across repetitions, enabling visualization of shrinkage patterns and comparisons across blocks with differing correlation structures.</p>
<hr>
<p>Across all metrics, comparisons are based on the empirical distributions obtained from repeated resampling rather than single-point estimates, allowing uncertainty and variability to be explicitly assessed.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>scale_train_test <span class="ot">&lt;-</span> <span class="cf">function</span>(Xtr, Xte){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(Xtr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(Xtr, <span class="dv">2</span>, sd)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  sd[sd <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  Xtr_s <span class="ot">&lt;-</span> <span class="fu">sweep</span>(<span class="fu">sweep</span>(Xtr, <span class="dv">2</span>, mu, <span class="st">"-"</span>), <span class="dv">2</span>, sd, <span class="st">"/"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  Xte_s <span class="ot">&lt;-</span> <span class="fu">sweep</span>(<span class="fu">sweep</span>(Xte, <span class="dv">2</span>, mu, <span class="st">"-"</span>), <span class="dv">2</span>, sd, <span class="st">"/"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(Xtr_s) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(Xtr)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(Xte_s) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(Xtr)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">Xtr =</span> Xtr_s, <span class="at">Xte =</span> Xte_s, <span class="at">mu =</span> mu, <span class="at">sd =</span> sd)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>block_mse <span class="ot">&lt;-</span> <span class="cf">function</span>(beta_hat, beta_true, block){</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">block =</span> <span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">coef_mse =</span> <span class="fu">c</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>((beta_hat[block<span class="sc">==</span><span class="st">"U"</span>]<span class="sc">-</span>beta_true[block<span class="sc">==</span><span class="st">"U"</span>])<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>((beta_hat[block<span class="sc">==</span><span class="st">"V"</span>]<span class="sc">-</span>beta_true[block<span class="sc">==</span><span class="st">"V"</span>])<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>((beta_hat[block<span class="sc">==</span><span class="st">"W"</span>]<span class="sc">-</span>beta_true[block<span class="sc">==</span><span class="st">"W"</span>])<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>((beta_hat[block<span class="sc">==</span><span class="st">"Z"</span>]<span class="sc">-</span>beta_true[block<span class="sc">==</span><span class="st">"Z"</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>drop_block_delta_mse <span class="ot">&lt;-</span> <span class="cf">function</span>(Xte, yte, beta_hat, block){</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  yhat_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Xte <span class="sc">%*%</span> beta_hat)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  mse_full  <span class="ot">&lt;-</span> <span class="fu">mean</span>((yte <span class="sc">-</span> yhat_full)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  deltas <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>), <span class="cf">function</span>(b){</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    beta2 <span class="ot">&lt;-</span> beta_hat</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    beta2[block<span class="sc">==</span>b] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    mse2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((yte <span class="sc">-</span> <span class="fu">as.numeric</span>(Xte <span class="sc">%*%</span> beta2))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    mse2 <span class="sc">-</span> mse_full</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">block=</span><span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>), <span class="at">delta_mse=</span>deltas)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>fit_one_split <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">test_frac=</span><span class="fl">0.3</span>, <span class="at">alpha_en=</span><span class="fl">0.5</span>){</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> dat<span class="sc">$</span>X; y <span class="ot">&lt;-</span> dat<span class="sc">$</span>y; beta_true <span class="ot">&lt;-</span> dat<span class="sc">$</span>beta; block <span class="ot">&lt;-</span> dat<span class="sc">$</span>block</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  id_te <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(n, <span class="at">size=</span><span class="fu">floor</span>(test_frac<span class="sc">*</span>n))</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  id_tr <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">seq_len</span>(n), id_te)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  Xtr0 <span class="ot">&lt;-</span> X[id_tr,]; ytr <span class="ot">&lt;-</span> y[id_tr]</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  Xte0 <span class="ot">&lt;-</span> X[id_te,]; yte <span class="ot">&lt;-</span> y[id_te]</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  sc <span class="ot">&lt;-</span> <span class="fu">scale_train_test</span>(Xtr0, Xte0)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  Xtr <span class="ot">&lt;-</span> sc<span class="sc">$</span>Xtr; Xte <span class="ot">&lt;-</span> sc<span class="sc">$</span>Xte</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----- OLS -----</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  ols_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(ytr <span class="sc">~</span> Xtr)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  beta_ols <span class="ot">&lt;-</span> <span class="fu">coef</span>(ols_fit)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">cbind</span>(<span class="dv">1</span>,Xte) <span class="sc">%*%</span> <span class="fu">coef</span>(ols_fit))</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>ols <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta=</span>beta_ols, <span class="at">yhat=</span>yhat, <span class="at">tune=</span><span class="cn">NA</span>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----- Ridge -----</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  cv_r <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(Xtr, ytr, <span class="at">alpha=</span><span class="dv">0</span>, <span class="at">standardize=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  b_r <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(cv_r, <span class="at">s=</span><span class="st">"lambda.min"</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  yhat_r <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(cv_r, <span class="at">newx=</span>Xte, <span class="at">s=</span><span class="st">"lambda.min"</span>))</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>ridge <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta=</span>b_r, <span class="at">yhat=</span>yhat_r, <span class="at">tune=</span>cv_r<span class="sc">$</span>lambda.min)</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----- Lasso -----</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  cv_l <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(Xtr, ytr, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">standardize=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  b_l <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(cv_l, <span class="at">s=</span><span class="st">"lambda.min"</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  yhat_l <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(cv_l, <span class="at">newx=</span>Xte, <span class="at">s=</span><span class="st">"lambda.min"</span>))</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>lasso <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta=</span>b_l, <span class="at">yhat=</span>yhat_l, <span class="at">tune=</span>cv_l<span class="sc">$</span>lambda.min)</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----- Elastic Net (alpha fixed) -----</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  cv_e <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(Xtr, ytr, <span class="at">alpha=</span>alpha_en, <span class="at">standardize=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  b_e <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(cv_e, <span class="at">s=</span><span class="st">"lambda.min"</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>  yhat_e <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(cv_e, <span class="at">newx=</span>Xte, <span class="at">s=</span><span class="st">"lambda.min"</span>))</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>enet <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta=</span>b_e, <span class="at">yhat=</span>yhat_e, <span class="at">tune=</span>cv_e<span class="sc">$</span>lambda.min)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----- PCR -----</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  df_tr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>ytr, Xtr)</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  pcr_fit <span class="ot">&lt;-</span> <span class="fu">pcr</span>(y <span class="sc">~</span> ., <span class="at">data=</span>df_tr, <span class="at">scale=</span><span class="cn">FALSE</span>, <span class="at">validation=</span><span class="st">"CV"</span>, <span class="at">segments=</span><span class="dv">10</span>)</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># choose k by CV RMSEP</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>  rmsep <span class="ot">&lt;-</span> <span class="fu">RMSEP</span>(pcr_fit, <span class="at">estimate=</span><span class="st">"CV"</span>)</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>  rm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(rmsep<span class="sc">$</span>val[<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="at">drop=</span><span class="cn">TRUE</span>])</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(rmsep<span class="sc">$</span>se[<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="at">drop=</span><span class="cn">TRUE</span>])</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>  k_min <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rm)</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>  thr <span class="ot">&lt;-</span> rm[k_min] <span class="sc">+</span> se[k_min]</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(rm <span class="sc">&lt;=</span> thr)</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  k_best <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(idx)<span class="sc">==</span><span class="dv">0</span>) k_min <span class="cf">else</span> idx[<span class="dv">1</span>]</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(<span class="at">k_min=</span>k_min, <span class="at">k_best=</span>k_best))</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  df_te <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Xte)  <span class="co"># must have same column names as training predictors</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>  yhat_p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(pcr_fit, <span class="at">newdata =</span> df_te, <span class="at">ncomp =</span> k_best))</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coefficients in original X space (no intercept)</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>  b_p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(pcr_fit, <span class="at">ncomp =</span> k_best, <span class="at">intercept =</span> <span class="cn">FALSE</span>))</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>pcr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta =</span> b_p, <span class="at">yhat =</span> yhat_p, <span class="at">tune =</span> k_best)</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- assemble metrics tidy ----</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>  methods <span class="ot">&lt;-</span> <span class="fu">names</span>(out)</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>  res_main <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(methods, <span class="cf">function</span>(m){</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    bh <span class="ot">&lt;-</span> out[[m]]<span class="sc">$</span>beta</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((yte <span class="sc">-</span> out[[m]]<span class="sc">$</span>yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    coefmse <span class="ot">&lt;-</span> <span class="fu">mean</span>((bh <span class="sc">-</span> beta_true)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">method=</span>m, <span class="at">test_mse=</span>mse, <span class="at">coef_mse=</span>coefmse,</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">tune=</span>out[[m]]<span class="sc">$</span>tune,</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>           <span class="at">l1=</span><span class="fu">sum</span>(<span class="fu">abs</span>(bh)), <span class="at">l2=</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(bh<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>  res_coef_block <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(methods, <span class="cf">function</span>(m){</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">block_mse</span>(out[[m]]<span class="sc">$</span>beta, beta_true, block) <span class="sc">%&gt;%</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">method=</span>m)</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>  res_drop <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(methods, <span class="cf">function</span>(m){</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_block_delta_mse</span>(Xte, yte, out[[m]]<span class="sc">$</span>beta, block) <span class="sc">%&gt;%</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">method=</span>m)</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># selection info (lasso + enet)</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>  sel <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">c</span>(<span class="st">"lasso"</span>,<span class="st">"enet"</span>), <span class="cf">function</span>(m){</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    bh <span class="ot">&lt;-</span> out[[m]]<span class="sc">$</span>beta</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">method=</span>m,</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>           <span class="at">n_selected=</span><span class="fu">sum</span>(bh<span class="sc">!=</span><span class="dv">0</span>),</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>           <span class="at">nU=</span><span class="fu">sum</span>(bh[block<span class="sc">==</span><span class="st">"U"</span>]<span class="sc">!=</span><span class="dv">0</span>),</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>           <span class="at">nV=</span><span class="fu">sum</span>(bh[block<span class="sc">==</span><span class="st">"V"</span>]<span class="sc">!=</span><span class="dv">0</span>),</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>           <span class="at">nW=</span><span class="fu">sum</span>(bh[block<span class="sc">==</span><span class="st">"W"</span>]<span class="sc">!=</span><span class="dv">0</span>),</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>           <span class="at">nZ=</span><span class="fu">sum</span>(bh[block<span class="sc">==</span><span class="st">"Z"</span>]<span class="sc">!=</span><span class="dv">0</span>),</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>           <span class="at">selected=</span><span class="fu">list</span>(<span class="fu">as.integer</span>(bh<span class="sc">!=</span><span class="dv">0</span>)))</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ---- store beta_hat for all methods (for shrinkage + correlation behavior) ----</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>  beta_hat_long <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(methods, <span class="cf">function</span>(m){</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> m,</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">j =</span> <span class="fu">seq_along</span>(out[[m]]<span class="sc">$</span>beta),</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta_hat =</span> out[[m]]<span class="sc">$</span>beta</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">main=</span>res_main, <span class="at">coef_block=</span>res_coef_block, <span class="at">drop=</span>res_drop, <span class="at">sel=</span>sel, <span class="at">beta_hat_long=</span>beta_hat_long)</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>jaccard <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b){</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>  inter <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> b<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>  uni   <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> b<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(uni<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>  inter<span class="sc">/</span>uni</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>jaccard_restrict <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, idx){</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> a[idx]; b <span class="ot">&lt;-</span> b[idx]</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>  inter <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> b<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>  uni   <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> b<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(uni<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>  inter<span class="sc">/</span>uni</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>get_jaccard_df <span class="ot">&lt;-</span> <span class="cf">function</span>(sel_df_method, <span class="at">n_pairs=</span><span class="dv">2000</span>){</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>  mats <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sel_df_method<span class="sc">$</span>selected)  <span class="co"># R x p</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>  Rn <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mats)</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>  pairs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_pairs, <span class="fu">sample.int</span>(Rn, <span class="dv">2</span>))</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>  js <span class="ot">&lt;-</span> <span class="fu">apply</span>(pairs, <span class="dv">2</span>, \(ij) <span class="fu">jaccard</span>(mats[ij[<span class="dv">1</span>],], mats[ij[<span class="dv">2</span>],]))</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">jaccard =</span> js)</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>get_jaccard_block_df <span class="ot">&lt;-</span> <span class="cf">function</span>(sel_df_method, block_vec, <span class="at">n_pairs=</span><span class="dv">2000</span>){</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>  mats <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sel_df_method<span class="sc">$</span>selected)  <span class="co"># R x p</span></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>  Rn <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mats)</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>  pairs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_pairs, <span class="fu">sample.int</span>(Rn, <span class="dv">2</span>))</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>  blocks <span class="ot">&lt;-</span> <span class="fu">unique</span>(block_vec)</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_dfr</span>(blocks, <span class="cf">function</span>(bk){</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(block_vec <span class="sc">==</span> bk)</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>    js <span class="ot">&lt;-</span> <span class="fu">apply</span>(pairs, <span class="dv">2</span>, \(ij) <span class="fu">jaccard_restrict</span>(mats[ij[<span class="dv">1</span>],], mats[ij[<span class="dv">2</span>],], idx))</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">block=</span>bk, <span class="at">jaccard=</span>js)</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="results" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="results"><span class="header-section-number">6.1.4</span> Results</h3>
<section id="predictive-performance-and-biasvariance-trade-off" class="level4" data-number="6.1.4.1">
<h4 data-number="6.1.4.1" class="anchored" data-anchor-id="predictive-performance-and-biasvariance-trade-off"><span class="header-section-number">6.1.4.1</span> Predictive performance and bias–variance trade-off</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p_pred_overall <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(main_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>test_mse, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.10</span>, <span class="at">height=</span><span class="dv">0</span>), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"Test MSE"</span>, <span class="at">title=</span><span class="st">"Out-of-sample predictive accuracy (overall)"</span>) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>p_pred_overall</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>drop_df<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(drop_df<span class="sc">$</span>block, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>p_pred_block <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(drop_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>delta_mse, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>block, <span class="at">nrow=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"MSE when dropping block"</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Out-of-sample predictive contribution by block (drop-one-block ΔMSE)"</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>p_pred_block</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Regularized methods outperform OLS in out-of-sample prediction, illustrating the bias–variance trade-off in the presence of correlated predictors. While OLS is unbiased, its high variance leads to inferior generalization. Ridge reduces variance through uniform shrinkage but offers limited gains when noise variables are present. Lasso and Elastic Net achieve the best predictive performance by reducing effective model complexity through shrinkage and sparsity. PCR provides weaker improvements, indicating that dimension reduction alone is insufficient when signal is sparse at the variable level.</p>
</section>
<section id="coefficient-estimation-accuracy" class="level4" data-number="6.1.4.2">
<h4 data-number="6.1.4.2" class="anchored" data-anchor-id="coefficient-estimation-accuracy"><span class="header-section-number">6.1.4.2</span> Coefficient estimation accuracy</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p_coef_overall <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(main_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>coef_mse, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.10</span>, <span class="at">height=</span><span class="dv">0</span>), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"Coefficient MSE"</span>, <span class="at">title=</span><span class="st">"Coefficient estimation error (overall)"</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>p_coef_overall</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>coef_block_df<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(coef_block_df<span class="sc">$</span>block, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>p_coef_block <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coef_block_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>coef_mse, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>block, <span class="at">nrow=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"Blockwise coefficient MSE"</span>, <span class="at">title=</span><span class="st">"Coefficient estimation error by block"</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>p_coef_block</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Coefficient estimation accuracy improves substantially under regularization. Lasso yields the lowest estimation error by eliminating weak and null coefficients, whereas Ridge introduces bias through uniform shrinkage of all coefficients. Elastic Net balances these effects, achieving moderate estimation error while improving stability. PCR performs poorly in coefficient recovery due to misalignment between principal components and the true sparse structure.</p>
</section>
<section id="variable-selection-sparsity-and-stability" class="level4" data-number="6.1.4.3">
<h4 data-number="6.1.4.3" class="anchored" data-anchor-id="variable-selection-sparsity-and-stability"><span class="header-section-number">6.1.4.3</span> Variable selection, sparsity, and stability</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p_sel_stab_overall <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jac_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>jaccard, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal_sel, <span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal_sel, <span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"Jaccard similarity"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Selection stability across resamples (overall)"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>p_sel_stab_overall</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sel_long <span class="ot">&lt;-</span> sel_df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rep, method, n_selected, nU, nV, nW, nZ) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(n_selected,nU,nV,nW,nZ), <span class="at">names_to=</span><span class="st">"block"</span>, <span class="at">values_to=</span><span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">block =</span> <span class="fu">recode</span>(block, <span class="at">n_selected=</span><span class="st">"Overall"</span>, <span class="at">nU=</span><span class="st">"U"</span>, <span class="at">nV=</span><span class="st">"V"</span>, <span class="at">nW=</span><span class="st">"W"</span>, <span class="at">nZ=</span><span class="st">"Z"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">block =</span> <span class="fu">factor</span>(block, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Overall"</span>,<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>)))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>p_sel_stab_block <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jac_block_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>jaccard, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>block, <span class="at">nrow=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal_sel, <span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal_sel, <span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"Jaccard similarity"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Selection stability across resamples (by block)"</span>) <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>p_sel_stab_block</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p_sel_count <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sel_long, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>count, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>block, <span class="at">nrow=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal_sel, <span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal_sel, <span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="at">lasso=</span><span class="st">"Lasso"</span>, <span class="at">enet=</span><span class="st">"Elastic Net"</span>)) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"# selected variables"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Selection sparsity (counts) overall and by block"</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>p_sel_count</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>jac_block_df<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(jac_block_df<span class="sc">$</span>block, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Lasso produces sparse but unstable variable selection, particularly in highly correlated predictor blocks. Elastic Net selects larger but more stable sets of variables by encouraging grouped selection among correlated predictors. This highlights a fundamental trade-off between sparsity and stability in penalized regression.</p>
</section>
<section id="shrinkage-behavior" class="level4" data-number="6.1.4.4">
<h4 data-number="6.1.4.4" class="anchored" data-anchor-id="shrinkage-behavior"><span class="header-section-number">6.1.4.4</span> Shrinkage behavior</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p_shrink_overall <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(main_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>l2, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"||"</span>, <span class="fu">hat</span>(beta), <span class="st">"||"</span>[<span class="dv">2</span>])),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Shrinkage magnitude (overall L2 norm)"</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>p_shrink_overall</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>block_l2_df<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(block_l2_df<span class="sc">$</span>block, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>block_l2_df<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="fu">factor</span>(block_l2_df<span class="sc">$</span>method, <span class="at">levels=</span>method_levels)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>p_shrink_block <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(block_l2_df, <span class="fu">aes</span>(<span class="at">x=</span>method, <span class="at">y=</span>block_l2, <span class="at">fill=</span>method, <span class="at">color=</span>method)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">linewidth=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>block, <span class="at">nrow=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>pal, <span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>method_labels) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"||"</span>, <span class="fu">hat</span>(beta)[block], <span class="st">"||"</span>[<span class="dv">2</span>])),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Shrinkage magnitude by block (L2 norm)"</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>p_shrink_block</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need beta_hat_df + true beta vector and block vector</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>beta_true_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">j=</span><span class="fu">seq_along</span>(dat<span class="sc">$</span>beta), <span class="at">beta_true=</span>dat<span class="sc">$</span>beta, <span class="at">block=</span>dat<span class="sc">$</span>block)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>beta_mean_df <span class="ot">&lt;-</span> beta_hat_df <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method, j, block) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">beta_hat_mean =</span> <span class="fu">mean</span>(beta_hat), <span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(beta_true_df, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"j"</span>,<span class="st">"block"</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>p_pattern_scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beta_mean_df, <span class="fu">aes</span>(<span class="at">x=</span>beta_true, <span class="at">y=</span>beta_hat_mean, <span class="at">color=</span>block)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linewidth=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">linewidth=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">size=</span><span class="fl">1.4</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">labeller=</span><span class="fu">as_labeller</span>(method_labels)) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">expression</span>(beta[j]<span class="sc">~</span><span class="st">"(true)"</span>),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">expression</span>(<span class="fu">bar</span>(<span class="fu">hat</span>(beta))[j]<span class="sc">~</span><span class="st">"(mean over resamples)"</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Shrinkage pattern: true vs estimated coefficients (colored by block)"</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  theme_pub</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>p_pattern_scatter</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Shrinkage behavior differs markedly across methods: Ridge applies strong global shrinkage, Lasso induces exact zeros, Elastic Net combines both mechanisms, and PCR lacks direct shrinkage in the original predictor space. In highly correlated blocks, OLS and PCR exhibit substantial coefficient instability, Ridge stabilizes estimates via shrinkage, and Elastic Net mitigates instability through grouped selection, whereas Lasso remains sensitive to correlation structure.</p>
</section>
<section id="effects-of-correlated-predictors" class="level4" data-number="6.1.4.5">
<h4 data-number="6.1.4.5" class="anchored" data-anchor-id="effects-of-correlated-predictors"><span class="header-section-number">6.1.4.5</span> Effects of correlated predictors</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>beta_sd_var<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(beta_sd_var<span class="sc">$</span>block, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"U"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Z"</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>beta_sd_var<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="fu">factor</span>(beta_sd_var<span class="sc">$</span>method, <span class="at">levels=</span>method_levels)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>p_corr_behavior <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beta_sd_var, <span class="fu">aes</span>(<span class="at">x=</span>block, <span class="at">y=</span>sd_beta, <span class="at">fill=</span>block)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.55</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.20</span>, <span class="at">width=</span><span class="fl">0.15</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">labeller=</span><span class="fu">as_labeller</span>(method_labels)) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Block"</span>, <span class="at">y=</span><span class="fu">expression</span>(<span class="fu">sd</span>(<span class="fu">hat</span>(beta)[j])),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Effect of correlation: coefficient instability by block"</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  theme_pub <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>p_corr_behavior</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-final_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Correlation among predictors has a pronounced impact on model behavior. In highly correlated blocks, OLS and PCR exhibit substantial coefficient instability due to near-nonidentifiability of the regression problem.</p>
</section>
</section>
<section id="summary" class="level3" data-number="6.1.5">
<h3 data-number="6.1.5" class="anchored" data-anchor-id="summary"><span class="header-section-number">6.1.5</span> Summary</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Test MSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(test_mse),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Coef MSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(coef_mse),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">||β̂||₂</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(l2),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  summary_table,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Overall predictive and estimation performance across methods"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Method"</span>, <span class="st">"Test MSE"</span>, <span class="st">"Coefficient MSE"</span>, <span class="st">"L2 Norm of β̂"</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overall predictive and estimation performance across methods</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: right;">Test MSE</th>
<th style="text-align: right;">Coefficient MSE</th>
<th style="text-align: right;">L2 Norm of β̂</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ols</td>
<td style="text-align: right;">1.570</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">4.267</td>
</tr>
<tr class="even">
<td style="text-align: left;">ridge</td>
<td style="text-align: right;">1.662</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">2.878</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lasso</td>
<td style="text-align: right;">1.223</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">3.660</td>
</tr>
<tr class="even">
<td style="text-align: left;">enet</td>
<td style="text-align: right;">1.277</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">3.416</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pcr</td>
<td style="text-align: right;">1.581</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">4.189</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 19%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Prediction</th>
<th>Coefficient Accuracy</th>
<th>Sparsity</th>
<th>Selection Stability</th>
<th>Correlated Predictors</th>
<th>Key Trade-off</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>OLS</td>
<td>Poor</td>
<td>Moderate</td>
<td>None</td>
<td>N/A</td>
<td>Very unstable</td>
<td>Unbiased but high variance</td>
</tr>
<tr class="even">
<td>Ridge</td>
<td>Moderate</td>
<td>Poor–Moderate</td>
<td>None</td>
<td>N/A</td>
<td>Stable shrinkage</td>
<td>Variance reduction without sparsity</td>
</tr>
<tr class="odd">
<td>Lasso</td>
<td>Best</td>
<td>Best</td>
<td>High</td>
<td>Low</td>
<td>Unstable selection</td>
<td>Sparsity vs stability</td>
</tr>
<tr class="even">
<td>Elastic Net</td>
<td>Best</td>
<td>Moderate–Good</td>
<td>Moderate</td>
<td>High</td>
<td>Grouped selection</td>
<td>Balanced regularization</td>
</tr>
<tr class="odd">
<td>PCR</td>
<td>Moderate</td>
<td>Poor</td>
<td>Implicit</td>
<td>N/A</td>
<td>Depends on alignment</td>
<td>Dimension reduction vs sparsity</td>
</tr>
</tbody>
</table>
<p>This exercise highlights how different regularization strategies trade off bias, variance, sparsity, and stability in a structured, correlated predictor setting.</p>
<p>Overall, methods that explicitly impose sparsity—lasso and elastic net—achieve superior out-of-sample predictive accuracy and substantially lower coefficient estimation error compared to unregularized OLS and dimension-reduction-based PCR. In particular, lasso performs best in terms of both prediction and estimation when the true signal is sparse, as it effectively suppresses noise variables while retaining the dominant coefficients.</p>
<p>Ridge regression exhibits the strongest overall shrinkage and the most stable coefficient estimates under high within-block correlation, but this comes at the cost of higher estimation bias and weaker variable discrimination. Elastic net balances these behaviors by combining <span class="math inline">\(\ell_1\)</span>-induced sparsity with <span class="math inline">\(\ell_2\)</span>-based stabilization, leading to improved selection stability relative to lasso while maintaining competitive predictive performance.</p>
<p>The blockwise analyses further clarify the interaction between correlation structure and regularization. Highly correlated blocks benefit from shrinkage-based methods, while sparsity-driven methods more accurately identify truly active predictors within moderately correlated blocks. Blocks containing no signal are consistently downweighted, especially by lasso and elastic net, demonstrating effective regularization against overfitting.</p>
<p>Finally, selection stability results show that elastic net produces more consistent variable selection across resamples than lasso, particularly in correlated blocks, underscoring the practical importance of combining sparsity and grouping effects.</p>
<p>Taken together, these results emphasize that no single regularization method is uniformly optimal. Instead, the appropriate choice depends on the underlying signal structure, correlation patterns, and the relative importance of prediction accuracy, interpretability, and stability.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-nonlinearity.html" class="pagination-link" aria-label="How Random Forests Capture Nonlinearity">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">How Random Forests Capture Nonlinearity</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="Summary">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>